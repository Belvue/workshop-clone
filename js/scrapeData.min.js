const puppeteer=require("puppeteer");var pageId,maxPageSize=0;async function main(gameId,pages){pageId=pages;var output=[];const browser=await puppeteer.launch({args:["--no-sandbox"],headless:!0}),page=await browser.newPage();await page.setViewport({width:1920,height:1080}),await page.setRequestInterception(!0),page.on("request",req=>{"stylesheet"==req.resourceType()||"font"==req.resourceType()||"image"==req.resourceType()?req.abort():req.continue()}),page.setUserAgent("Mozilla/5.0 (Linux; Android 6.0; Nexus 5 Build/MRA58N) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/71.0.3571.0 Mobile Safari/537.36"),await page.goto(`https://steamcommunity.com/workshop/browse/?appid=${gameId}&browsesort=trend&section=readytouseitems&actualsort=trend&p=${pageId}`);const elem="div.workshopItem";if(await page.waitForSelector(elem,{timeout:2e3}),1===pageId)try{maxPageSize=await page.$eval("a.pagelink:nth-child(4)",page=>parseInt(page.innerText.replace(",","")))}catch(ex){maxPageSize=1}const collection=await page.$$(elem);for(let i=0;i<collection.length;i++){const elemz=collection[i],mod=await elemz.$eval(".workshopItemTitle",modName=>modName.innerText),link=await elemz.$eval("a",href=>href.href.replace("&searchtext=","")),author=await elemz.$eval(".workshopItemAuthorName a",author=>author.innerText),totalItems=await page.$eval(".workshopBrowsePagingInfo",items=>parseInt(items.innerText.split(" ")[3].replace(",",""))),image=await elemz.$eval(".workshopItemPreviewHolder .workshopItemPreviewImage",image=>image.src);output.push({Mod:mod,Author:author,Link:link,Image:image,totalItems:totalItems})}return await browser.close(),new Promise(resolve=>{resolve(output)})}module.exports={main:main};